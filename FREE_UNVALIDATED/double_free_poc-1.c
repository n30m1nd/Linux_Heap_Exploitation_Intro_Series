#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define WORD_SIZE ((size_t)-1 > 0xffffffffUL ? 8 : 4)
#define SIZEOFNORMALCHUNK 0x100-WORD_SIZE
#define SIZEOFFASTCHUNK 0x60-WORD_SIZE

int main()
{
	char *A, *B;
	printf("\n[+] malloc A(0x100) \n");
	A = malloc(SIZEOFNORMALCHUNK);
	printf("A at %p\n", A);
	sprintf(A, "This is A's contents");

	free(A);

	printf("\n[+] malloc B(0x100) \n");
	B = malloc(SIZEOFNORMALCHUNK);
	printf("B %p\n", B);

	printf("\n[+] Double free()'ing A\n");
	free(A);

	printf("B is still valid in the code but under the hood\n\
		it is free for the allocator... B contents [%s]\n", B); 

	return 0;
}
